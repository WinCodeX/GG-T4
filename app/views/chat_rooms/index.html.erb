<!-- app/views/chat_rooms/index.html.erb -->
<%= turbo_frame_tag :dashboard do %>
<div class="flex h-[calc(100vh-4rem)] mt-16">
  <!-- ğŸ§­ First Sidebar (Your main sidebar is already fixed) -->
  <div class="w-64"></div> <!-- Leave space for the fixed sidebar -->

  <!-- ğŸ’¬ Chat List Sidebar -->
  <aside class="w-80 bg-[#1e1f29] border-r border-[#44475a] overflow-y-auto p-4">
    <h2 class="text-lg font-semibold text-[#f8f8f2] mb-4">Your Chats</h2>
    
    <% @chat_rooms.each do |room| %>
      <% recipient = room.other_participant(current_user) %>
      <%= link_to chat_room_path(room), class: "block mb-2 p-3 rounded-lg bg-[#282a36] text-[#f8f8f2] hover:bg-[#44475a] transition" do %>
        <div class="flex items-center gap-3">
          <% if recipient.avatar.attached? %>
            <%= image_tag recipient.avatar.variant(resize_to_fill: [40, 40]), class: "rounded-full h-10 w-10 object-cover" %>
          <% else %>
            <%= image_tag avatar_url_for(recipient), class: "rounded-full h-10 w-10 object-cover" %>
          <% end %>
          <div>
            <div class="font-medium"><%= recipient.username || recipient.email.split('@').first %></div>
            <div class="text-xs text-[#6272a4]">Last message preview here</div>
          </div>
        </div>
      <% end %>
    <% end %>
  </aside>

  <!-- Placeholder for chat room details (if any) -->
  <div class="flex-1 bg-[#0d0d0d]">
    <div class="h-full flex items-center justify-center text-[#6272a4]">
      Select a chat to start messaging.
    </div>
  </div>
</div>
<% end %>