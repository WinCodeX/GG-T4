<% user ||= current_user %>

<div class="flex items-center space-x-4">
  <!-- Avatar -->
  <% if user.avatar.attached? %>
    <%= image_tag user.avatar.variant(resize_to_fill: [48, 48]), class: "rounded-full h-12 w-12 object-cover" %>
  <% else %>
    <%= image_tag avatar_url_for(user), class: "rounded-full h-12 w-12 object-cover" %>
  <% end %>

  <!-- Username and Status -->
  <div class="flex flex-col justify-center">
    <span class="text-xl font-semibold text-gray-100">
      <%= user.username || user.email.split('@').first %>
    </span>

    <!-- ✅ Turbo Stream Subscription -->
    <%= turbo_stream_from "user_status_#{user.id}" %>

    <!-- ✅ Turbo Frame Tag to replace on broadcast -->
    <%= turbo_frame_tag dom_id(user, :status) do %>
      <%= render "shared/user_status", user: user %>
    <% end %>
  </div>
</div>