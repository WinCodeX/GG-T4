<nav class="flex items-center justify-between bg-[#1f202d] border-b-2 border-[#bd93f9] p-4 text-white shadow-md rounded-b-xl">

  <!-- 🧠 App Name -->
  <div class="text-xl font-bold">
    <%= link_to "GG T4", root_path, class: "hover:text-purple-400 transition" %>
  </div>

  <!-- 🔍 User Search -->
  <div class="w-1/2 px-4 relative" data-controller="user-search">
  <input type="text"
         name="query"
         placeholder="Search users..."
         data-user-search-target="input"
         data-action="input->user-search#search"
         class="w-full px-4 py-2 rounded-md bg-[#282a36] text-white placeholder-[#6272a4] focus:outline-none focus:ring-2 focus:ring-[#bd93f9] text-sm" />

  <div id="search-results"
       class="absolute z-50 top-full mt-2 w-full bg-[#1e1f29] text-white rounded-lg shadow-xl border border-[#44475a]">
    <!-- Results appear here -->
  </div>
</div>


  <!-- 🧠 Turbo Frame for Live Results -->
  <turbo-frame id="search_results"
               class="absolute top-full left-0 mt-2 w-full bg-[#1e1f29] text-white rounded-md shadow-lg border border-[#44475a] z-50 overflow-hidden">
    <!-- Results will be dynamically injected here -->
  </turbo-frame>
</div>


  <!-- 👤 User Menu -->
  <div>
    <% if user_signed_in? %>
      <div x-data="{ open: false }" class="relative inline-block text-left">
        <!-- 🖼 Avatar -->
        <div
          class="flex items-center cursor-pointer select-none"
          @click="open = !open"
          @click.outside="open = false">
          <% if current_user.avatar.attached? %>
          <span class="text-xl text-gray-100"><%= current_user.username || current_user.email.split('@').first %></span>
            <%= image_tag current_user.avatar.variant(resize_to_fill: [48, 48]), class: "rounded-full h-12 w-12 object-cover" %>
          <% else %>
            <span class="text-xl text-gray-100"><%= current_user.username || current_user.email.split('@').first %></span>
            <%= image_tag avatar_url_for(current_user), class: "rounded-full h-12 w-12 object-cover" %>
          <% end %>
        </div>

        <!-- 📂 Dropdown Menu -->
        <div
          x-show="open"
          x-cloak
          class="absolute right-0 mt-2 w-48 bg-white text-black rounded-md shadow-lg z-50 transition-opacity duration-200"
        >
          <% if current_user.client? %>
            <%= link_to "Dashboard", clients_dashboard_path, class: "block px-4 py-2 hover:bg-gray-100" %>
          <% elsif current_user.admin? %>
            <%= link_to "Dashboard", admin_dashboard_path, class: "block px-4 py-2 hover:bg-gray-100" %>
          <% elsif current_user.agent? %>
            <%= link_to "Dashboard", agents_dashboard_path, class: "block px-4 py-2 hover:bg-gray-100" %>
          <% elsif current_user.rider? %>
            <%= link_to "Dashboard", riders_dashboard_path, class: "block px-4 py-2 hover:bg-gray-100" %>
          <% end %>

          <%= link_to "Edit Profile", edit_user_registration_path, class: "block px-4 py-2 hover:bg-gray-100" %>
          <%= link_to "Settings", "#", class: "block px-4 py-2 hover:bg-gray-100" %>

          <%= button_to "Logout", destroy_user_session_path,
              method: :delete,
              form_class: "w-full text-left",
              data: { turbo: false },
              class: "block px-4 py-2 text-red-600 hover:bg-gray-100" %>
        </div>
      </div>
    <% else %>
      <%= link_to "Login", new_user_session_path, class: "mr-4 hover:text-purple-400 transition" %>
      <%= link_to "Sign Up", new_user_registration_path, class: "hover:text-purple-400 transition" %>
    <% end %>
  </div>
</nav>
